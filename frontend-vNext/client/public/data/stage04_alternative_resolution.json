{
  "stage": 4,
  "stageName": "Alternative Resolution",
  "success": true,
  "expansions": [
    {
      "id": "EXP-ACT-007",
      "originalActivityId": "ACT-007",
      "originalActivityName": "Documentation of Non-Childbearing Status or Pregnancy Test",
      "expandedActivities": [
        {
          "id": "ACT-007-A",
          "name": "Documentation of Non-Childbearing Status",
          "instanceType": "Activity",
          "cdiscDomain": null,
          "_alternativeResolution": {
            "originalActivityId": "ACT-007",
            "originalActivityName": "Documentation of Non-Childbearing Status or Pregnancy Test",
            "alternativeType": "mutually_exclusive",
            "alternativeIndex": 1,
            "alternativeCount": 2,
            "confidence": 0.98,
            "rationale": "The keyword 'or' explicitly separates two mutually exclusive options: providing documentation or performing a test.",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.047925Z",
            "source": "cache",
            "cacheHit": true,
            "cacheKey": "a3b0c1122638daf5379999399e0c152a"
          }
        },
        {
          "id": "ACT-007-B",
          "name": "Pregnancy Test",
          "instanceType": "Activity",
          "cdiscDomain": null,
          "_alternativeResolution": {
            "originalActivityId": "ACT-007",
            "originalActivityName": "Documentation of Non-Childbearing Status or Pregnancy Test",
            "alternativeType": "mutually_exclusive",
            "alternativeIndex": 2,
            "alternativeCount": 2,
            "confidence": 0.98,
            "rationale": "The keyword 'or' explicitly separates two mutually exclusive options: providing documentation or performing a test.",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048201Z",
            "source": "cache",
            "cacheHit": true,
            "cacheKey": "a3b0c1122638daf5379999399e0c152a"
          }
        }
      ],
      "expandedSais": [
        {
          "id": "SAI-027-A",
          "instanceType": "ScheduledActivityInstance",
          "activityId": "ACT-007-A",
          "scheduledInstanceEncounterId": "ENC-001",
          "defaultConditionId": "COND-ALT-007-A",
          "isRequired": true,
          "footnoteMarkers": [],
          "_alternativeResolution": {
            "originalSaiId": "SAI-027",
            "originalActivityId": "ACT-007",
            "alternativeIndex": 1,
            "alternativeName": "Documentation of Non-Childbearing Status",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048180Z",
            "confidence": 0.98,
            "source": "cache",
            "cacheHit": true
          },
          "timingModifier": null
        },
        {
          "id": "SAI-028-A",
          "instanceType": "ScheduledActivityInstance",
          "activityId": "ACT-007-A",
          "scheduledInstanceEncounterId": "ENC-002",
          "defaultConditionId": "COND-ALT-007-A",
          "isRequired": true,
          "footnoteMarkers": [],
          "_alternativeResolution": {
            "originalSaiId": "SAI-028",
            "originalActivityId": "ACT-007",
            "alternativeIndex": 1,
            "alternativeName": "Documentation of Non-Childbearing Status",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048187Z",
            "confidence": 0.98,
            "source": "cache",
            "cacheHit": true
          },
          "timingModifier": null
        },
        {
          "id": "SAI-029-A",
          "instanceType": "ScheduledActivityInstance",
          "activityId": "ACT-007-A",
          "scheduledInstanceEncounterId": "ENC-005",
          "defaultConditionId": "COND-ALT-007-A",
          "isRequired": true,
          "footnoteMarkers": [],
          "_alternativeResolution": {
            "originalSaiId": "SAI-029",
            "originalActivityId": "ACT-007",
            "alternativeIndex": 1,
            "alternativeName": "Documentation of Non-Childbearing Status",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048195Z",
            "confidence": 0.98,
            "source": "cache",
            "cacheHit": true
          },
          "timingModifier": null
        },
        {
          "id": "SAI-027-B",
          "instanceType": "ScheduledActivityInstance",
          "activityId": "ACT-007-B",
          "scheduledInstanceEncounterId": "ENC-001",
          "defaultConditionId": "COND-ALT-007-B",
          "isRequired": true,
          "footnoteMarkers": [],
          "_alternativeResolution": {
            "originalSaiId": "SAI-027",
            "originalActivityId": "ACT-007",
            "alternativeIndex": 2,
            "alternativeName": "Pregnancy Test",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048212Z",
            "confidence": 0.98,
            "source": "cache",
            "cacheHit": true
          },
          "timingModifier": null
        },
        {
          "id": "SAI-028-B",
          "instanceType": "ScheduledActivityInstance",
          "activityId": "ACT-007-B",
          "scheduledInstanceEncounterId": "ENC-002",
          "defaultConditionId": "COND-ALT-007-B",
          "isRequired": true,
          "footnoteMarkers": [],
          "_alternativeResolution": {
            "originalSaiId": "SAI-028",
            "originalActivityId": "ACT-007",
            "alternativeIndex": 2,
            "alternativeName": "Pregnancy Test",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048216Z",
            "confidence": 0.98,
            "source": "cache",
            "cacheHit": true
          },
          "timingModifier": null
        },
        {
          "id": "SAI-029-B",
          "instanceType": "ScheduledActivityInstance",
          "activityId": "ACT-007-B",
          "scheduledInstanceEncounterId": "ENC-005",
          "defaultConditionId": "COND-ALT-007-B",
          "isRequired": true,
          "footnoteMarkers": [],
          "_alternativeResolution": {
            "originalSaiId": "SAI-029",
            "originalActivityId": "ACT-007",
            "alternativeIndex": 2,
            "alternativeName": "Pregnancy Test",
            "stage": "Stage4AlternativeResolution",
            "model": "gemini-2.5-pro",
            "timestamp": "2025-12-09T16:05:27.048219Z",
            "confidence": 0.98,
            "source": "cache",
            "cacheHit": true
          },
          "timingModifier": null
        }
      ],
      "conditionsCreated": [
        {
          "id": "COND-ALT-007-A",
          "instanceType": "Condition",
          "name": "Documentation of Non-Childbearing Status selected",
          "text": "Subject assigned to Documentation of Non-Childbearing Status option for Documentation of Non-Childbearing Status or Pregnancy Test",
          "conditionType": {
            "id": "CODE-COND-TYPE-EXT-ALT-002",
            "code": "EXT-ALT-002",
            "decode": "Mutually Exclusive Alternative",
            "codeSystem": "http://protocol-digitalization.example.org/codesystem/soa-alternative-resolution",
            "codeSystemVersion": "1.0.0",
            "instanceType": "Code"
          },
          "_alternativeResolution": {
            "originalActivityId": "ACT-007",
            "alternativeIndex": 1,
            "alternativeName": "Documentation of Non-Childbearing Status",
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048171Z"
          }
        },
        {
          "id": "COND-ALT-007-B",
          "instanceType": "Condition",
          "name": "Pregnancy Test selected",
          "text": "Subject assigned to Pregnancy Test option for Documentation of Non-Childbearing Status or Pregnancy Test",
          "conditionType": {
            "id": "CODE-COND-TYPE-EXT-ALT-002",
            "code": "EXT-ALT-002",
            "decode": "Mutually Exclusive Alternative",
            "codeSystem": "http://protocol-digitalization.example.org/codesystem/soa-alternative-resolution",
            "codeSystemVersion": "1.0.0",
            "instanceType": "Code"
          },
          "_alternativeResolution": {
            "originalActivityId": "ACT-007",
            "alternativeIndex": 2,
            "alternativeName": "Pregnancy Test",
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048210Z"
          }
        }
      ],
      "assignmentsCreated": [
        {
          "id": "CA-ALT-7B4B84",
          "instanceType": "ConditionAssignment",
          "conditionId": "COND-ALT-007-A",
          "conditionTargetId": "SAI-027-A",
          "_alternativeResolution": {
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048185Z"
          }
        },
        {
          "id": "CA-ALT-558FB4",
          "instanceType": "ConditionAssignment",
          "conditionId": "COND-ALT-007-A",
          "conditionTargetId": "SAI-028-A",
          "_alternativeResolution": {
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048190Z"
          }
        },
        {
          "id": "CA-ALT-10C46A",
          "instanceType": "ConditionAssignment",
          "conditionId": "COND-ALT-007-A",
          "conditionTargetId": "SAI-029-A",
          "_alternativeResolution": {
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048197Z"
          }
        },
        {
          "id": "CA-ALT-A1F93D",
          "instanceType": "ConditionAssignment",
          "conditionId": "COND-ALT-007-B",
          "conditionTargetId": "SAI-027-B",
          "_alternativeResolution": {
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048214Z"
          }
        },
        {
          "id": "CA-ALT-DEBC13",
          "instanceType": "ConditionAssignment",
          "conditionId": "COND-ALT-007-B",
          "conditionTargetId": "SAI-028-B",
          "_alternativeResolution": {
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048218Z"
          }
        },
        {
          "id": "CA-ALT-A39A6F",
          "instanceType": "ConditionAssignment",
          "conditionId": "COND-ALT-007-B",
          "conditionTargetId": "SAI-029-B",
          "_alternativeResolution": {
            "stage": "Stage4AlternativeResolution",
            "timestamp": "2025-12-09T16:05:27.048221Z"
          }
        }
      ],
      "confidence": 0.98,
      "alternativeType": "mutually_exclusive",
      "requiresReview": false,
      "reviewReason": null
    }
  ],
  "decisions": {
    "ACT-007": {
      "activityId": "ACT-007",
      "activityName": "Documentation of Non-Childbearing Status or Pregnancy Test",
      "isAlternative": true,
      "alternativeType": "mutually_exclusive",
      "alternatives": [
        {
          "name": "Documentation of Non-Childbearing Status",
          "order": 1,
          "confidence": 0.98,
          "cdiscDomain": null,
          "isPreferred": false
        },
        {
          "name": "Pregnancy Test",
          "order": 2,
          "confidence": 0.98,
          "cdiscDomain": null,
          "isPreferred": false
        }
      ],
      "recommendedAction": "expand",
      "confidence": 0.98,
      "rationale": "The keyword 'or' explicitly separates two mutually exclusive options: providing documentation or performing a test.",
      "source": "cache",
      "requiresHumanReview": false,
      "reviewReason": null,
      "cachedAt": "2025-12-09T00:51:22.479049Z",
      "modelName": "gemini-2.5-pro"
    },
    "ACT-008": {
      "activityId": "ACT-008",
      "activityName": "Chemistry/Hematology",
      "isAlternative": false,
      "alternativeType": null,
      "alternatives": [],
      "recommendedAction": "keep",
      "confidence": 1.0,
      "rationale": "The '/' in 'Chemistry/Hematology' is a common convention for listing two required lab panels (Chemistry and Hematology), not an alternative choice. This is analogous to 'Test A and Test B'.",
      "source": "cache",
      "requiresHumanReview": false,
      "reviewReason": null,
      "cachedAt": "2025-12-09T00:51:22.479075Z",
      "modelName": "gemini-2.5-pro"
    }
  },
  "reviewItems": [],
  "metrics": {
    "activitiesAnalyzed": 2,
    "alternativesDetected": 1,
    "activitiesExpanded": 1,
    "saisCreated": 6,
    "conditionsCreated": 2,
    "assignmentsCreated": 6,
    "autoApplied": 1,
    "needsReview": 0,
    "timingPatternsFiltered": 0,
    "unitPatternsFiltered": 0,
    "cacheHits": 2,
    "llmCalls": 0,
    "validationDiscrepancies": 0,
    "referentialIntegrityErrors": 0
  }
}