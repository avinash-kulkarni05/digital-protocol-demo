You are an expert clinical trial protocol analyst. Your task is to extract ALL eligibility criteria (inclusion or exclusion) from a specific section of a clinical trial protocol.

**CRITICAL REQUIREMENTS - READ CAREFULLY:**

⚠️ **VERBATIM EXTRACTION ONLY** - You MUST return criteria EXACTLY as they appear in the PDF:
- If the PDF has 10 inclusion criteria, you MUST return exactly 10 inclusion criteria
- If the PDF has 7 exclusion criteria, you MUST return exactly 7 exclusion criteria
- DO NOT summarize, paraphrase, condense, or reword any criterion
- DO NOT merge multiple criteria into one
- DO NOT skip any criteria for any reason
- DO NOT change a single word - copy text CHARACTER BY CHARACTER

**IMPORTANT INSTRUCTIONS:**

1. **Extract ALL numbered criteria** - Do not skip any criteria, even if they seem redundant or reference other sections. COUNT the criteria in the PDF and ensure your output has the SAME count.

2. **Preserve exact wording** - Copy the criterion text EXACTLY as written in the protocol (including grammar/spelling errors). Do NOT fix typos, do NOT improve grammar, do NOT simplify language.

3. **Handle multi-level numbering:**
   - Main criteria: "1. Age >= 18 years"
   - Sub-criteria: "a. Must sign consent" or "i. Lab value < 2.0"
   - Sub-sub-criteria: "• Additional detail" or "- Further specification"

4. **Capture cross-references:**
   - If a criterion references an appendix (e.g., "Must meet criteria in Appendix B"), include the full text
   - If a criterion references another section, note the reference

5. **Identify criterion type:**
   - "inclusion" or "exclusion"

6. **Handle compound criteria:**
   - If a single numbered item contains multiple distinct conditions connected by "AND", extract as one criterion
   - If conditions are connected by "OR", still extract as one criterion (we'll handle OR logic later)

7. **Preserve formatting elements:**
   - Units: "< 2.0 mg/dL", ">= 18 years"
   - Ranges: "between 18-65 years"
   - Percentages: "< 50% decrease"
   - Timeframes: "within 28 days", "at least 6 months"

8. **Track page numbers (PROVENANCE):**
   - Identify which page(s) each criterion appears on within the provided page range
   - If a criterion spans multiple pages, list ALL pages it appears on
   - Return as an array: [33] for single page, [33, 34] for criterion spanning pages 33-34

**OUTPUT FORMAT (JSON only, no additional text):**

{{
  "criteria": [
    {{
      "criterion_number": "<original number from protocol, e.g., '1', '2a', '3.i'>",
      "criterion_text": "<exact text of the criterion>",
      "criterion_type": "inclusion" or "exclusion",
      "page_numbers": [<list of page numbers where this criterion appears, e.g., [33] or [33, 34]>],
      "has_cross_reference": true/false,
      "cross_reference_target": "<appendix/section reference if applicable>",
      "notes": "<any ambiguities or special observations>"
    }},
    ...
  ],
  "total_count": <integer>,
  "section_header": "<the header of the section that was extracted>",
  "extraction_notes": "<any overall observations about the extraction>"
}}

**EXAMPLES:**

Example 1 - Simple inclusion criteria:
{{
  "criteria": [
    {{
      "criterion_number": "1",
      "criterion_text": "Age >= 18 years at the time of signing the informed consent form",
      "criterion_type": "inclusion",
      "page_numbers": [45],
      "has_cross_reference": false,
      "cross_reference_target": null,
      "notes": null
    }},
    {{
      "criterion_number": "2",
      "criterion_text": "Histologically or cytologically confirmed diagnosis of non-small cell lung cancer (NSCLC)",
      "criterion_type": "inclusion",
      "page_numbers": [45],
      "has_cross_reference": false,
      "cross_reference_target": null,
      "notes": null
    }},
    {{
      "criterion_number": "3",
      "criterion_text": "Must meet tumor classification criteria as defined in Appendix B",
      "criterion_type": "inclusion",
      "page_numbers": [45, 46],
      "has_cross_reference": true,
      "cross_reference_target": "Appendix B",
      "notes": "May need to extract Appendix B content separately. Criterion spans pages 45-46."
    }}
  ],
  "total_count": 3,
  "section_header": "5.2.1 Inclusion Criteria",
  "extraction_notes": "All criteria extracted successfully from pages 45-47"
}}

Example 2 - Exclusion criteria with sub-items:
{{
  "criteria": [
    {{
      "criterion_number": "1",
      "criterion_text": "History of prior systemic anti-cancer therapy for advanced or metastatic NSCLC, including:
a. Chemotherapy within 4 weeks of first study drug administration
b. Immunotherapy within 6 weeks of first study drug administration
c. Any investigational agent within 4 weeks or 5 half-lives",
      "criterion_type": "exclusion",
      "page_numbers": [48, 49],
      "has_cross_reference": false,
      "cross_reference_target": null,
      "notes": "Compound criterion with 3 sub-items (a, b, c). Spans pages 48-49."
    }},
    {{
      "criterion_number": "2",
      "criterion_text": "Active brain metastases or leptomeningeal disease",
      "criterion_type": "exclusion",
      "page_numbers": [49],
      "has_cross_reference": false,
      "cross_reference_target": null,
      "notes": null
    }}
  ],
  "total_count": 2,
  "section_header": "5.2.2 Exclusion Criteria",
  "extraction_notes": "Criterion 1 contains hierarchical sub-criteria that should be preserved as written"
}}

Example 3 - OR logic criterion:
{{
  "criteria": [
    {{
      "criterion_number": "5",
      "criterion_text": "Patient has ONE of the following:
(A) Spinal cord compression
(B) Untreated CNS metastases requiring immediate neurosurgical intervention",
      "criterion_type": "exclusion",
      "page_numbers": [50],
      "has_cross_reference": false,
      "cross_reference_target": null,
      "notes": "OR-logic criterion - patient excluded if they have EITHER condition A OR condition B"
    }}
  ],
  "total_count": 1,
  "section_header": "5.2.2 Exclusion Criteria",
  "extraction_notes": "Contains OR logic that will be parsed in later stages"
}}

**SECTION TO EXTRACT:**

Criterion Type: {criterion_type}
Section Header: {section_header}
Pages: {start_page} to {end_page}

**PROTOCOL TEXT (from specified page range):**

{protocol_section_text}

**YOUR RESPONSE (JSON only):**
