system
You are an expert at finding source locations in clinical protocol documents. Your task is to provide precise provenance (source location) for extracted study arms, epochs, and design metadata.

user
### OBJECTIVE
For each element in the extracted data below, provide the provenance showing WHERE in the protocol document the information was derived from.

You have the PDF document available. Search through it to find the EXACT source location for each extracted value.

### EXTRACTED DATA (from Pass 1)
{{ extracted_data }}

## CRITICAL RULES - READ CAREFULLY

### Rule 1: PRESERVE ALL EXISTING FIELDS EXACTLY
- DO NOT rename any fields
- DO NOT remove any fields
- DO NOT change any values from Pass 1
- The structure from Pass 1 MUST remain exactly the same

### Rule 2: WHERE TO ADD PROVENANCE
Add a `provenance` object to:
- Root level
- Each `studyArms[]` item
- Each `interventions[]` item (inside studyArms)
- Each `doseModifications` object (inside intervention)
- Each `modificationTriggers[]` item (inside doseModifications)
- Each `reductionLevels[]` item (inside doseModifications, only if it already has provenance field allowed)
- Each `studyEpochs[]` item
- Each `studyCells[]` item
- `designMetadata` object
- Each `stratificationFactors[]` item (inside designMetadata)
- `randomizationDetails` object (inside designMetadata, if present)
- Each `enrollmentCaps[]` item (inside designMetadata, if present)
- `adaptiveRandomization` object (inside designMetadata, if present and not null)
- `reRandomization` object (inside designMetadata, if present and not null)
- `drugSupply` object (if present)
- Each `kitTypes[]` item (inside drugSupply)

### Rule 3: WHERE NOT TO ADD PROVENANCE - CRITICAL
DO NOT add provenance to these objects (they have `additionalProperties: false`):
- `dosingRegimen` - NO provenance allowed
- `biomedicalConcept` - NO provenance allowed
- `role` (interventionRole) - NO provenance allowed
- `armType` (armTypeCode) - NO provenance allowed
- `epochType` (epochTypeCode) - NO provenance allowed
- `designType` (designTypeCode) - NO provenance allowed
- `route` (routeOfAdministration) - NO provenance allowed

### Rule 4: KEEP STRING ARRAYS AS STRINGS
`permanentDiscontinuationTriggers` is an array of STRINGS. DO NOT convert these to objects.

**WRONG:**
```json
"permanentDiscontinuationTriggers": [
  {"value": "Grade 4 Febrile Neutropenia", "provenance": {...}}  // WRONG!
]
```

**CORRECT:**
```json
"permanentDiscontinuationTriggers": [
  "Grade 4 Febrile Neutropenia"  // Keep as simple string
]
```

### YOUR TASK
For elements where provenance IS allowed, provide:
- `section_number`: Protocol section number (e.g., "5.1", "6.1", "10.1") or null if not visible
- `page_number`: EXACT physical page number as an integer (1-indexed)
- `text_snippet`: Direct quote from protocol (max 500 chars)

### PROVENANCE STRUCTURE
```json
{
  "provenance": {
    "section_number": "5.1",       // String or null
    "page_number": 20,             // Integer (1-indexed)
    "text_snippet": "..."          // Max 500 chars
  }
}
```

### CRITICAL PAGE NUMBER RULES
1. Use PHYSICAL page numbers (1st page of PDF = 1, 2nd page = 2, etc.)
2. Do NOT use page numbers printed in headers/footers (like "Page 17 of 200")
3. The text_snippet MUST appear on the EXACT page_number you specify
4. Your provenance will be VERIFIED against the source PDF

### PROTOCOL SECTION MAPPING

Use these standard section numbers:

| Content Type | Typical Section |
|-------------|-----------------|
| Study Design Overview | 5.1 |
| Study Arms/Groups | 5.2, 6.1 |
| Study Epochs/Periods | 5.3, 7.1 |
| Randomization | 5.4, 10.1 |
| Stratification Factors | 5.4, 10.1, 11.1 |
| IRT/IWRS/RTSM | 6.3, 10.1 |
| Enrollment Caps | 5.4, 10.1 |
| Blinding | 5.5 |
| Investigational Product | 6.1, 6.2 |
| Dose Modifications | 6.5, 6.6 |
| Drug Supply | 6.3 |
| Adaptive Design | 11.1, 14.1 |

### PROVENANCE RULES

1. **Quote ACTUAL TEXT** from the protocol that the value was derived from
2. **Never use boilerplate** like headers, page numbers, or "Confidential"
3. **Truncate to 500 chars** max, ending with "..."
4. **For derived values**, quote the source text used to derive the value
5. **Page numbers must be integers** (not strings)
6. **Copy text EXACTLY** as it appears - no paraphrasing

### COMPLETE EXAMPLE

**INPUT (from Pass 1):**
```json
{
  "studyArms": [
    {
      "id": "ARM01",
      "name": "DS-1062a 6.0 mg/kg",
      "interventions": [
        {
          "id": "INT01",
          "name": "DS-1062a",
          "dosingRegimen": {
            "dose": 6.0,
            "doseUnit": "mg/kg",
            "frequency": "Q3W"
          },
          "biomedicalConcept": {
            "conceptName": "Datopotamab Deruxtecan",
            "cdiscCode": "C174271",
            "domain": "CM"
          },
          "doseModifications": {
            "reductionLevels": [...],
            "modificationTriggers": [
              {
                "id": "TRIG01",
                "condition": "Grade 3 nausea",
                "action": "Hold then reduce"
              }
            ],
            "permanentDiscontinuationTriggers": [
              "Grade 4 Febrile Neutropenia",
              "Grade 2 or greater ILD/Pneumonitis"
            ]
          }
        }
      ]
    }
  ]
}
```

**OUTPUT (with provenance):**
```json
{
  "provenance": {
    "section_number": "5.1",
    "page_number": 20,
    "text_snippet": "This is a Phase 3, multicenter, open-label study of DS-1062a..."
  },
  "studyArms": [
    {
      "id": "ARM01",
      "name": "DS-1062a 6.0 mg/kg",
      "provenance": {
        "section_number": "5.2",
        "page_number": 22,
        "text_snippet": "Arm 1: DS-1062a 6.0 mg/kg administered as IV infusion..."
      },
      "interventions": [
        {
          "id": "INT01",
          "name": "DS-1062a",
          "provenance": {
            "section_number": "6.1",
            "page_number": 30,
            "text_snippet": "DS-1062a (datopotamab deruxtecan) is supplied as..."
          },
          "dosingRegimen": {
            "dose": 6.0,
            "doseUnit": "mg/kg",
            "frequency": "Q3W"
          },
          "biomedicalConcept": {
            "conceptName": "Datopotamab Deruxtecan",
            "cdiscCode": "C174271",
            "domain": "CM"
          },
          "doseModifications": {
            "provenance": {
              "section_number": "6.5",
              "page_number": 85,
              "text_snippet": "Dose modifications for DS-1062a are described below..."
            },
            "reductionLevels": [...],
            "modificationTriggers": [
              {
                "id": "TRIG01",
                "condition": "Grade 3 nausea",
                "action": "Hold then reduce",
                "provenance": {
                  "section_number": "6.5.1",
                  "page_number": 88,
                  "text_snippet": "For Grade 3 nausea, hold treatment until resolved..."
                }
              }
            ],
            "permanentDiscontinuationTriggers": [
              "Grade 4 Febrile Neutropenia",
              "Grade 2 or greater ILD/Pneumonitis"
            ]
          }
        }
      ]
    }
  ]
}
```

Notice in the example above:
- `dosingRegimen` has NO provenance added (not allowed)
- `biomedicalConcept` has NO provenance added (not allowed)
- `permanentDiscontinuationTriggers` stays as a simple string array (no objects)
- Provenance is added only at allowed levels

### VERIFICATION CHECKLIST

Before output, verify:
- [ ] ALL original fields from Pass 1 are preserved
- [ ] NO provenance added to dosingRegimen, biomedicalConcept, role, armType, epochType, designType, route
- [ ] permanentDiscontinuationTriggers is still a string array (not objects)
- [ ] text_snippets are â‰¤500 characters
- [ ] page_numbers are integers
- [ ] section_number is string or null (never missing)

### OUTPUT FORMAT

Return JSON with provenance added only at allowed locations. Maintain the same structure as the input.

### OUTPUT
Return ONLY valid JSON with the provenance structure, no additional text.
